---
openapi: 3.0.3
info:
  title: ramen-ai-backend
  version: 1.0.0
servers: []
paths:
  "/api/v1/auth/google":
    post:
      summary: google_auth
      tags:
      - Api::V1::Session
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                token:
                  type: string
              required:
              - token
            example:
              token: valid_token
      responses:
        '200':
          description: returns existing user if already exists
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                      name:
                        type: string
                      image:
                        type: string
                    required:
                    - id
                    - email
                    - name
                    - image
                required:
                - token
                - user
              example:
                token: eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo4LCJleHAiOjE3NTc4MTgzNTF9.Zd7WeANw-uiT2rOjdXpgeonwEkJz29p17xfjFoElyrU
                user:
                  id: 8
                  email: user@example.com
                  name: User 1
                  image: https://example.com/user_image.png
        '401':
          description: returns unauthorized error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                required:
                - error
              example:
                error: Invalid token
  "/api/v1/menu_with_shops/{id}":
    get:
      summary: show
      tags:
      - Api::V1::MenuWithShop
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
        example: 4
      responses:
        '200':
          description: returns a specific menu
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  name:
                    type: string
                  genre_name:
                    type: string
                  noodle_name:
                    type: string
                  soup_name:
                    type: string
                  image_url:
                    type: string
                  shop:
                    type: object
                    properties:
                      id:
                        type: integer
                      name:
                        type: string
                      address:
                        type: string
                      google_map_url:
                        type: string
                    required:
                    - id
                    - name
                    - address
                    - google_map_url
                required:
                - id
                - name
                - genre_name
                - noodle_name
                - soup_name
                - image_url
                - shop
              example:
                id: 4
                name: 特製ラーメン
                genre_name: ラーメン
                noodle_name: 太麺
                soup_name: 豚骨
                image_url: http://example.com/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NCwicHVyIjoiYmxvYl9pZCJ9fQ==--83a855877ac63974e22537dbc3c93bd9ed88cc06/ramen.png
                shop:
                  id: 4
                  name: ラーメン屋
                  address: 東京都新宿区
                  google_map_url: https://maps.app.goo.gl/BvuQTxGsmKLJ68yL9
  "/api/v1/random_menus":
    get:
      summary: index
      tags:
      - Api::V1::RandomMenu
      responses:
        '200':
          description: returns all menus
          content:
            application/json:
              schema:
                type: object
                properties:
                  menus:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        name:
                          type: string
                        genre_name:
                          type: string
                        noodle_name:
                          type: string
                        soup_name:
                          type: string
                        image_url:
                          type: string
                      required:
                      - id
                      - name
                      - genre_name
                      - noodle_name
                      - soup_name
                      - image_url
                required:
                - menus
              example:
                menus:
                - id: 5
                  name: 博多ラーメン
                  genre_name: ラーメン
                  noodle_name: 細麺
                  soup_name: 豚骨スープ
                  image_url: http://example.com/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NSwicHVyIjoiYmxvYl9pZCJ9fQ==--5e71d675486112121c7d516bdee1a6e6f4fa8c7e/ramen.png
  "/api/v1/recommended_menus":
    post:
      summary: create
      tags:
      - Api::V1::RecommendedMenu
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                select_menu_ids:
                  type: array
                  items:
                    type: string
                not_select_menu_ids:
                  type: array
                  items:
                    type: string
              required:
              - select_menu_ids
            example:
              select_menu_ids:
              - '1'
              - '2'
              not_select_menu_ids:
              - '3'
              - '4'
      responses:
        '200':
          description: returns a recommended menu based on select_menu_ids & not_select_menu_ids
          content:
            application/json:
              schema:
                type: object
                properties:
                  recommended_menu:
                    type: object
                    properties:
                      id:
                        type: integer
                      name:
                        type: string
                      genre_name:
                        type: string
                      noodle_name:
                        type: string
                      soup_name:
                        type: string
                      image_url:
                        type: string
                      shop:
                        type: object
                        properties:
                          id:
                            type: integer
                          name:
                            type: string
                          address:
                            type: string
                          google_map_url:
                            type: string
                        required:
                        - id
                        - name
                        - address
                        - google_map_url
                    required:
                    - id
                    - name
                    - genre_name
                    - noodle_name
                    - soup_name
                    - image_url
                    - shop
                  reason:
                    type: string
                required:
                - recommended_menu
                - reason
              example:
                recommended_menu:
                  id: 7
                  name: Ramen 5
                  genre_name: ラーメン
                  noodle_name: 太麺
                  soup_name: 豚骨
                  image_url: http://example.com/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NywicHVyIjoiYmxvYl9pZCJ9fQ==--774468f5466901d03ec584c32fdb0a99c76c7d25/ramen.png
                  shop:
                    id: 7
                    name: ラーメン屋
                    address: 東京都新宿区
                    google_map_url: https://maps.app.goo.gl/BvuQTxGsmKLJ68yL9
                reason: 魚介つけ麺や二郎系ラーメンなど、濃厚でインパクトのある味をお好みのようですので、同じく濃厚な「豚骨」スープのラーメンをおすすめします。特に食べ応えのある太麺との相性は抜群で、鶏ガラとはまた違ったクリーミーで深みのある味わいをお楽しみいただけます。
        '400':
          description: returns an error if select_menu_ids is missing
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                required:
                - error
              example:
                error: select_menu_idsが必要です
  "/api/v1/shops":
    get:
      summary: index
      tags:
      - Api::V1::Shop
      responses:
        '200':
          description: returns all shops
          content:
            application/json:
              schema:
                type: object
                properties:
                  shops:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        name:
                          type: string
                        address:
                          type: string
                        google_map_url:
                          type: string
                      required:
                      - id
                      - name
                      - address
                      - google_map_url
                required:
                - shops
              example:
                shops:
                - id: 9
                  name: 九州 筑豊ラーメン山小屋
                  address: 佐賀県嬉野市嬉野町大字下宿甲４００２−４
                  google_map_url: https://maps.app.goo.gl/BvuQTxGsmKLJ68yL9
  "/api/v1/shops/{id}":
    get:
      summary: show
      tags:
      - Api::V1::Shop
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
        example: 10
      responses:
        '200':
          description: returns a specific shop
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  name:
                    type: string
                  address:
                    type: string
                  google_map_url:
                    type: string
                required:
                - id
                - name
                - address
                - google_map_url
              example:
                id: 10
                name: 九州 筑豊ラーメン山小屋
                address: 佐賀県嬉野市嬉野町大字下宿甲４００２−４
                google_map_url: https://maps.app.goo.gl/BvuQTxGsmKLJ68yL9
  "/api/v1/admin/users":
    get:
      summary: index
      tags:
      - Api::V1::Admin::User
      security:
      - bearerAuth: []
      responses:
        '200':
          description: returns all users
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    email:
                      type: string
                    name:
                      type: string
                    provider:
                      type: string
                    uid:
                      type: string
                    image:
                      type: string
                      nullable: true
                    google_id:
                      type: string
                      nullable: true
                    email_verified:
                      type: boolean
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - email
                  - name
                  - provider
                  - uid
                  - image
                  - google_id
                  - email_verified
                  - created_at
                  - updated_at
              example:
              - id: 1
                email: user1@example.com
                name: User One
                provider: google
                uid: abc123xyz
                image: https://example.com/image1.png
                google_id: null
                email_verified: false
                created_at: '2026-02-02T22:18:19.575+09:00'
                updated_at: '2026-02-02T22:18:19.575+09:00'
              - id: 2
                email: user2@example.com
                name: User Two
                provider: google
                uid: def456uvw
                image: https://example.com/image2.png
                google_id: null
                email_verified: false
                created_at: '2026-02-02T22:20:30.123+09:00'
                updated_at: '2026-02-02T22:20:30.123+09:00'
        '401':
          description: returns unauthorized error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                required:
                - error
              example:
                error: Unauthorized
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
